---
import { Icon } from "astro-icon/components";
import Image from "astro/components/Image.astro";
import ThemeSwitcher from "~/components/theme-switcher.astro";
import ApplyModal from "~/components/apply-modal.astro";
import BottomNav from "~/components/bottom-nav.astro";
import type { NavItem } from "~/types";

const navItems: Array<NavItem> = [
  { title: "Talent", url: "#talents" },
  { title: "Contact Us", url: "#contact" },
  { title: "About Us", url: "#aboutus" },
];
---

<header
  id="page-header"
  class="fixed top-0 left-0 right-0 z-20 flex w-full items-center justify-between border-b border-transparent px-4 sm:px-8 py-4 bg-default/10 backdrop-blur-sm"
>
  <a class="flex items-center gap-3 hover:!text-default flex-shrink-0" href="#">
    <h1 class="sr-only">Unides</h1>
    <Image src="/unides_yellow.png" alt="Unides Logo" class="h-6 sm:h-8 w-auto" width={200} height={50}/>
  </a>
  
  <!-- Desktop Navigation -->
  <div class="desktop-nav flex-grow justify-center">
    <nav class="flex">
      <ul class="flex items-center gap-4 lg:gap-8">
        {
          navItems.map(({ title, url }) => (
            <li>
              <a class="text-sm lg:text-base font-medium nav-link whitespace-nowrap" href={url}>
                {title}
              </a>
            </li>
          ))
        }
      </ul>
    </nav>
  </div>
  
  <!-- Desktop Right Section -->
  <div class="flex items-center gap-4 sm:gap-6 flex-shrink-0">
    <!-- Apply Now Button -->
    <button
      type="button"
      class="hidden sm:block bg-primary text-white px-4 py-2 rounded-lg font-medium text-sm hover:bg-primary/90 transition-all shadow-md"
      onclick="openApplyModal()"
    >
      Apply Now
    </button>

    <!-- Theme Switcher -->
    <ThemeSwitcher />
  </div>

</header>

<!-- Apply Modal -->
<ApplyModal />

<!-- Bottom Navigation for Mobile -->
<BottomNav />

<script>
  const header = document.getElementById('page-header');
  const page = document.documentElement;

  // Handle scroll for fixed header
  if (header) {
    document.addEventListener('scroll', () => {
      const d = page.clientHeight - page.scrollTop - header.offsetHeight;
      header.classList.toggle('fixed-header', d < 0);
    });
  }
</script>



<style>
  .fixed-header {
    @apply fixed bottom-auto top-0;
    @apply border-default bg-default text-default;
  }
  
  .modal.is-open {
    @apply block;
  }
  
  /* Ensure header is visible and properly sized */
  #page-header {
    min-height: 64px;
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;
  }
  
  /* Desktop navigation visibility */
  .desktop-nav {
    display: none;
  }
  
  @media (min-width: 768px) {
    .desktop-nav {
      display: flex !important;
    }
    
    #page-header .desktop-nav {
      display: flex !important;
      visibility: visible !important;
    }
    
    #page-header .desktop-nav nav {
      display: flex !important;
      visibility: visible !important;
    }
    
    #page-header .desktop-nav nav ul {
      display: flex !important;
      visibility: visible !important;
    }
  }
  

  
  /* Desktop navigation styles */
  .nav-link {
    position: relative;
    padding: 0.5rem 1rem;
    font-weight: 600;
    letter-spacing: 0.02em;
    transition: all 0.3s ease;
    border-radius: 6px;
    background: transparent !important;
    box-shadow: none;
    color: inherit !important;
    display: inline-block;
    text-decoration: none;
    overflow: hidden;
  }
  
  /* Slide-in underline effect */
  .nav-link::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    height: 2px;
    width: 0;
    background: #fd5d13;
    transition: width 0.3s ease;
  }
  
  .nav-link:hover::after {
    width: 100%;
  }
  
  /* Focus state for accessibility */
  .nav-link:focus {
    outline: 2px solid #fd5d13;
    outline-offset: 2px;
    color: #fd5d13;
    transform: scale(1.05);
    background: rgba(253, 93, 19, 0.1);
  }
  
  .nav-link:focus::after {
    width: 100%;
  }
  
  /* Enhanced hover state */
  .nav-link:hover {
    color: #fd5d13;
    transform: scale(1.05);
    background: rgba(253, 93, 19, 0.05) !important;
    box-shadow: 0 0 15px rgba(253, 93, 19, 0.1);
    animation: subtle-pulse 2s ease-in-out infinite;
  }
  
  @keyframes subtle-pulse {
    0%, 100% { 
      box-shadow: 0 0 15px rgba(253, 93, 19, 0.1); 
    }
    50% { 
      box-shadow: 0 0 20px rgba(253, 93, 19, 0.2); 
    }
  }
  

  
  /* Responsive adjustments */
  @media (max-width: 768px) {
    #page-header {
      min-height: 56px;
    }
    
    .nav-link {
      padding: 0.375rem 0.75rem;
      font-size: 0.875rem;
    }
  }
  

</style>
